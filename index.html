<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FF Mestre - MOD EDITION</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            margin: 0; overflow: hidden; background-color: #050505; color: white; 
            font-family: 'Arial Black', sans-serif; user-select: none; touch-action: none;
        }
        canvas { display: block; }
        
        /* Mod Menu Styles */
        #mod-menu {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 280px; background: rgba(20, 20, 20, 0.95); border: 2px solid #00ff00;
            border-radius: 10px; z-index: 2000; padding: 15px; display: none;
            box-shadow: 0 0 20px #00ff00; pointer-events: auto;
        }
        .mod-btn {
            position: fixed; top: 100px; left: 10px; width: 50px; height: 50px;
            background: #1a1a1a; border: 2px solid #00ff00; border-radius: 12px;
            display: flex; justify-content: center; align-items: center;
            font-size: 24px; cursor: pointer; z-index: 1500; pointer-events: auto;
        }
        .cheat-toggle {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 10px; padding: 8px; border-bottom: 1px solid #333;
        }
        .switch {
            width: 40px; height: 20px; background: #444; border-radius: 10px; position: relative; cursor: pointer;
        }
        .switch.active { background: #00ff00; }
        .switch::after {
            content: ''; position: absolute; width: 16px; height: 16px; 
            background: white; border-radius: 50%; top: 2px; left: 2px; transition: 0.2s;
        }
        .switch.active::after { left: 22px; }

        /* UI Elements */
        #overlay {
            position: fixed; inset: 0; background: radial-gradient(circle, #220000, #000);
            display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 3000;
        }
        .joystick-base {
            width: 100px; height: 100px; background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 50%; pointer-events: auto;
        }
        .btn-fire {
            width: 80px; height: 80px; background: rgba(255, 0, 0, 0.3);
            border: 3px solid #ff4444; border-radius: 50%; pointer-events: auto;
            display: flex; justify-content: center; align-items: center; font-weight: bold;
        }
    </style>
</head>
<body>

<div id="overlay">
    <h1 class="text-5xl font-black text-red-600 italic mb-2">MESTRE 2024</h1>
    <p class="text-yellow-500 font-bold mb-8">V1.0 MOD MENU LOADED</p>
    <button id="start-btn" class="bg-red-600 px-12 py-4 rounded-full text-xl font-bold border-b-4 border-red-900 active:scale-95">
        INICIAR HACK
    </button>
</div>

<!-- Floating Mod Button -->
<div class="mod-btn" id="mod-toggle-btn">ðŸ‘¾</div>

<!-- Mod Menu Content -->
<div id="mod-menu">
    <h2 class="text-green-500 font-bold text-center mb-4 border-b border-green-500 pb-2">GHOST CHEATS V1</h2>
    <div class="cheat-toggle">
        <span>God Mode (Imortal)</span>
        <div class="switch" onclick="toggleCheat('godMode', this)"></div>
    </div>
    <div class="cheat-toggle">
        <span>Infinite Ammo (Fast)</span>
        <div class="switch" onclick="toggleCheat('fastShoot', this)"></div>
    </div>
    <div class="cheat-toggle">
        <span>Speed Hack</span>
        <div class="switch" onclick="toggleCheat('speedHack', this)"></div>
    </div>
    <button onclick="instaMestre()" class="w-full bg-yellow-600 py-2 rounded mt-2 font-bold">INSTA-MESTRE (MAX SCORE)</button>
    <button onclick="document.getElementById('mod-menu').style.display='none'" class="w-full bg-red-800 py-1 rounded mt-4 text-xs">FECHAR MENU</button>
</div>

<!-- HUD -->
<div id="hud" class="fixed top-0 left-0 w-full p-4 pointer-events-none hidden flex justify-between z-50">
    <div class="bg-black/60 p-2 rounded border-l-4 border-red-600">
        <div class="w-32 h-3 bg-gray-800 rounded overflow-hidden">
            <div id="hp-fill" class="h-full bg-red-600 w-full transition-all"></div>
        </div>
        <div class="text-[10px] font-bold mt-1">HP: <span id="hp-txt">100</span></div>
    </div>
    <div class="text-right bg-black/60 p-2 rounded border-r-4 border-yellow-500">
        <div id="rank-txt" class="text-yellow-500 font-black italic text-sm">PLATINA</div>
        <div id="score-txt" class="text-white text-[10px]">KILLS: 0</div>
    </div>
</div>

<!-- Mobile Controls -->
<div class="fixed bottom-10 w-full flex justify-between px-10 pointer-events-none hidden" id="controls">
    <div class="joystick-base" id="joy-base">
        <div class="w-10 h-10 bg-white/40 rounded-full m-auto mt-7" id="joy-stick"></div>
    </div>
    <div class="btn-fire" id="btn-fire">FIRE</div>
</div>

<canvas id="game"></canvas>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    
    // Game State
    let audioCtx;
    let gameActive = false;
    let score = 0;
    let player = { x: 0, y: 0, radius: 18, angle: 0, hp: 100, speed: 4 };
    let enemies = [];
    let bullets = [];
    let joyData = { x: 0, y: 0, active: false };
    
    // Cheat States
    const cheats = {
        godMode: false,
        fastShoot: false,
        speedHack: false
    };

    function initAudio() {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }

    function playSound(freq, type, duration, vol, decay = true) {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        if(decay) osc.frequency.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        gain.gain.setValueAtTime(vol, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + duration);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    }

    // Mod Menu Logic
    document.getElementById('mod-toggle-btn').onclick = () => {
        const menu = document.getElementById('mod-menu');
        menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        playSound(800, 'sine', 0.1, 0.05, false);
    };

    function toggleCheat(name, el) {
        cheats[name] = !cheats[name];
        el.classList.toggle('active');
        playSound(400, 'square', 0.05, 0.05, false);
        
        if(name === 'speedHack') player.speed = cheats.speedHack ? 10 : 4;
    }

    function instaMestre() {
        score = 9999;
        document.getElementById('score-txt').innerText = "KILLS: " + score;
        document.getElementById('rank-txt').innerText = "MESTRE";
        document.getElementById('rank-txt').style.color = "#ff0000";
        playSound(1000, 'sine', 0.5, 0.1);
    }

    function fire() {
        if(!gameActive) return;
        playSound(150, 'square', 0.1, 0.1);
        bullets.push({
            x: player.x + Math.cos(player.angle) * 20,
            y: player.y + Math.sin(player.angle) * 20,
            vx: Math.cos(player.angle) * 15,
            vy: Math.sin(player.angle) * 15
        });
        
        if(cheats.fastShoot) {
            // Rajada de tiros no modo hack
            setTimeout(fire, 50);
        }
    }

    // Controls & Touch
    const joyBase = document.getElementById('joy-base');
    const joyStick = document.getElementById('joy-stick');

    function handleMove(e) {
        if (!gameActive) return;
        const t = e.touches ? e.touches[0] : e;
        const r = joyBase.getBoundingClientRect();
        const cx = r.left + r.width/2;
        const cy = r.top + r.height/2;
        let dx = t.clientX - cx;
        let dy = t.clientY - cy;
        const d = Math.hypot(dx, dy);
        if(d > 50) { dx *= 50/d; dy *= 50/d; }
        joyData.x = dx/50; joyData.y = dy/50;
        joyStick.style.transform = `translate(${dx}px, ${dy}px)`;
        if(Math.hypot(dx, dy) > 5) player.angle = Math.atan2(dy, dx);
    }

    joyBase.addEventListener('touchstart', (e) => { joyData.active = true; handleMove(e); });
    joyBase.addEventListener('touchmove', handleMove);
    joyBase.addEventListener('touchend', () => {
        joyData.x = 0; joyData.y = 0;
        joyStick.style.transform = `translate(0,0)`;
    });

    document.getElementById('btn-fire').addEventListener('touchstart', (e) => { e.preventDefault(); fire(); });

    function spawnEnemy() {
        if (!gameActive) return;
        const side = Math.floor(Math.random()*4);
        let x, y;
        if(side==0){ x=-50; y=Math.random()*canvas.height; }
        else if(side==1){ x=canvas.width+50; y=Math.random()*canvas.height; }
        else if(side==2){ x=Math.random()*canvas.width; y=-50; }
        else { x=Math.random()*canvas.width; y=canvas.height+50; }
        enemies.push({ x, y, radius: 15, speed: 1.5 + (score/100) });
        setTimeout(spawnEnemy, Math.max(200, 1200 - (score*2)));
    }

    function update() {
        if (!gameActive) return;
        ctx.fillStyle = '#080808';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Grid background
        ctx.strokeStyle = '#111';
        for(let i=0; i<canvas.width; i+=40) { ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,canvas.height); ctx.stroke(); }

        // Move Player
        player.x += joyData.x * player.speed;
        player.y += joyData.y * player.speed;
        
        // Draw Player
        ctx.save();
        ctx.translate(player.x, player.y);
        ctx.rotate(player.angle);
        ctx.fillStyle = cheats.godMode ? '#00ff00' : '#ff4444';
        ctx.beginPath();
        ctx.moveTo(22, 0); ctx.lineTo(-12, -18); ctx.lineTo(-12, 18); ctx.closePath();
        ctx.fill();
        ctx.strokeStyle = 'white';
        ctx.lineWidth = 2;
        ctx.stroke();
        ctx.restore();

        // Bullets
        bullets.forEach((b, i) => {
            b.x += b.vx; b.y += b.vy;
            ctx.fillStyle = cheats.fastShoot ? '#00ff00' : 'yellow';
            ctx.beginPath(); ctx.arc(b.x, b.y, 4, 0, Math.PI*2); ctx.fill();
            if(b.x<0||b.x>canvas.width||b.y<0||b.y>canvas.height) bullets.splice(i, 1);
        });

        // Enemies
        enemies.forEach((en, i) => {
            const a = Math.atan2(player.y - en.y, player.x - en.x);
            en.x += Math.cos(a) * en.speed;
            en.y += Math.sin(a) * en.speed;

            ctx.fillStyle = '#333';
            ctx.beginPath(); ctx.arc(en.x, en.y, en.radius, 0, Math.PI*2); ctx.fill();
            ctx.strokeStyle = '#ff0000'; ctx.stroke();

            // Hit logic
            bullets.forEach((b, bi) => {
                if(Math.hypot(b.x-en.x, b.y-en.y) < en.radius + 5) {
                    enemies.splice(i, 1);
                    bullets.splice(bi, 1);
                    score++;
                    playSound(80, 'sine', 0.1, 0.05);
                    updateRank();
                }
            });

            // Player Damage
            if(!cheats.godMode && Math.hypot(player.x-en.x, player.y-en.y) < player.radius + en.radius) {
                player.hp -= 0.8;
                document.getElementById('hp-fill').style.width = player.hp + "%";
                document.getElementById('hp-txt').innerText = Math.ceil(player.hp);
                if(player.hp <= 0) location.reload();
            }
        });

        requestAnimationFrame(update);
    }

    function updateRank() {
        document.getElementById('score-txt').innerText = "KILLS: " + score;
        const r = document.getElementById('rank-txt');
        if(score > 100) { r.innerText = "MESTRE"; r.style.color = "#ff0000"; }
        else if(score > 40) { r.innerText = "DIAMANTE"; r.style.color = "#44aaff"; }
    }

    document.getElementById('start-btn').onclick = () => {
        initAudio();
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('hud').classList.remove('hidden');
        document.getElementById('controls').classList.remove('hidden');
        gameActive = true;
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        player.x = canvas.width/2; player.y = canvas.height/2;
        spawnEnemy();
        update();
        playSound(440, 'sine', 0.5, 0.1);
    };

    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });

</script>
</body>
</html>
